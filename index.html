<!DOCTYPE html>
<html lang="pt-BR">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista da Vez</title>
    <!-- Font Awesome para ícones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <style>
      :root {
        --bg-color: #f4f4f4;
        --card-bg: #ffffff;
        --text-color: #333;
        --button-bg: #007bff;
        --button-hover: #0056b3;
        --export-button-bg: #28a745;
        --export-button-hover: #218838;
        --border-color: #ddd;
        --shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      [data-theme="dark"] {
        --bg-color: #1a1a1a;
        --card-bg: #2c2c2c;
        --text-color: #e0e0e0;
        --border-color: #444;
        --shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }

      * {
        box-sizing: border-box;
      }

      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background-color: var(--bg-color);
        color: var(--text-color);
        transition: background-color 0.3s, color 0.3s;
      }

      h2,
      h3 {
        color: var(--text-color);
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      .card {
        background-color: var(--card-bg);
        padding: 20px;
        margin-bottom: 20px;
        border-radius: 8px;
        box-shadow: var(--shadow);
        border: 1px solid var(--border-color);
      }

      input[type="email"],
      input[type="password"],
      input[type="text"],
      select {
        width: 100%;
        padding: 12px;
        margin-bottom: 15px;
        border: 1px solid var(--border-color);
        border-radius: 4px;
        font-size: 16px;
        background-color: var(--card-bg);
        color: var(--text-color);
      }

      button {
        background-color: var(--button-bg);
        color: white;
        padding: 12px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: background-color 0.2s;
      }

      button:hover {
        background-color: var(--button-hover);
      }

      .download-buttons button,
      .report-section button {
        background-color: var(--export-button-bg);
      }

      .download-buttons button:hover,
      .report-section button:hover {
        background-color: var(--export-button-hover);
      }

      #salesList .card {
        margin-top: 15px;
        padding: 15px;
      }

      .report-section input[type="text"] {
        width: 100%;
        max-width: 300px;
        display: inline-block;
        margin-right: 10px;
      }

      .theme-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        background-color: transparent;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: var(--text-color);
      }

      .accordion-header {
        display: none;
        cursor: pointer;
        padding: 10px;
        background-color: var(--button-bg);
        color: white;
        border-radius: 4px;
        margin-bottom: 10px;
      }

      .accordion-content {
        display: block;
      }

      @media (max-width: 768px) {
        body {
          margin: 10px;
        }

        .container {
          padding: 0 10px;
        }

        input[type="email"],
        input[type="password"],
        input[type="text"],
        select {
          font-size: 14px;
          padding: 10px;
        }

        button {
          font-size: 14px;
          padding: 10px 15px;
          width: 100%;
          margin-bottom: 10px;
        }

        .report-section input[type="text"] {
          max-width: 100%;
          margin-bottom: 10px;
        }

        .accordion-header {
          display: block;
        }

        .accordion-content {
          display: none;
        }

        .accordion-content.active {
          display: block;
        }
      }
    </style>
    <script type="text/javascript" src="./index.js" defer=""></script>
    <link rel="stylesheet" href="./index.css">
  </head>

  <body>
    <button class="theme-toggle" id="themeToggle" title="Alternar Modo Claro/Escuro">
      <i class="fas fa-moon"></i>
    </button>
    <div class="container">
      <h2>Lista da Vez</h2>
      <div id="authSection" class="card">
        <h3>Login / Cadastro</h3>
        <input type="email" id="email" placeholder="Email">
        <input type="password" id="password" placeholder="Senha">
        <button id="registerBtn"><i class="fas fa-user-plus"></i> Cadastrar</button>
        <button id="loginBtn"><i class="fas fa-sign-in-alt"></i> Entrar</button>
      </div>
      <div id="salesSection" style="display: none;">
        <div class="card">
          <h3 class="accordion-header">Gerenciar Vendedores</h3>
          <div class="accordion-content active">
            <div class="card">
              <h4>Adicionar Vendedor</h4>
              <input type="text" id="vendorName" placeholder="Nome do Vendedor">
              <button id="addVendorBtn"><i class="fas fa-user-plus"></i> Adicionar Vendedor</button>
            </div>
            <div class="card">
              <h4>Check-in de Vendedores</h4>
              <div id="vendorCheckInList"></div>
              <button id="resetQueueBtn"><i class="fas fa-undo"></i> Resetar Fila</button>
            </div>
            <div class="card">
              <h4>Fila de Vendedores</h4>
              <div id="vendorQueue"></div>
            </div>
          </div>
        </div>
        <div class="card">
          <h3 class="accordion-header">Registrar Atendimento</h3>
          <div class="accordion-content active">
            <div class="card">
              <h4>Informações do Atendimento</h4>
              <select id="vendorAssigned" disabled="">
                <option value="">Aguardando vendedor...</option>
              </select>
            </div>
            <div class="card">
              <h4>Resultado do Atendimento</h4>
              <select id="saleResult">
                <option value="sold">Venda Realizada</option>
                <option value="not_sold">Não Vendido</option>
              </select>
              <input type="text" id="notSoldReason" placeholder="Motivo da Não Venda" style="display: none;">
              <input type="text" id="saleDetails" placeholder="Detalhes da Venda (opcional)">
            </div>
            <button id="submitSale"><i class="fas fa-save"></i> Registrar Atendimento</button>
            <button id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Sair</button>
          </div>
        </div>
        <div class="card">
          <h3 class="accordion-header">Exportar Relatórios</h3>
          <div class="accordion-content active download-buttons">
            <button id="exportPdfBtn"><i class="fas fa-file-pdf"></i> Baixar PDF</button>
            <button id="exportExcelBtn"><i class="fas fa-file-excel"></i> Baixar Excel</button>
          </div>
        </div>
        <div class="card">
          <h3 class="accordion-header">Enviar Relatório por Número</h3>
          <div class="accordion-content active report-section">
            <input type="text" id="phoneNumber" placeholder="Número de Telefone (Ex: 5511987654321)">
            <button id="sendReportBtn"><i class="fas fa-paper-plane"></i> Enviar Relatório</button>
            <small>Para WhatsApp, use o formato completo com código do país (ex: 55 para Brasil).</small>
          </div>
        </div>
        <div class="card">
          <h3>Histórico de Atendimentos</h3>
          <div id="salesList"></div>
        </div>
      </div>
    </div>
    <script type="module">
      import {
        initializeApp
      } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
      import {
        getAuth,
        createUserWithEmailAndPassword,
        signInWithEmailAndPassword,
        onAuthStateChanged,
        signOut
      } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
      import {
        getDatabase,
        ref,
        push,
        set,
        update,
        onValue,
        remove
      } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

      const firebaseConfig = {
        apiKey: "AIzaSyDJBdK9I-jtg9ujTc9Xsxr-hnPfkId4wIU",
        authDomain: "pdv1-77632.firebaseapp.com",
        databaseURL: "https://pdv1-77632-default-rtdb.firebaseio.com",
        projectId: "pdv1-77632",
        storageBucket: "pdv1-77632.firebasestorage.app",
        messagingSenderId: "246033791117",
        appId: "1:246033791117:web:7b70b511ea8d8c5ba1cac4",
        measurementId: "G-NTG13SG6VM"
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth();
      const db = getDatabase();
      let currentSalesData = [];
      let vendorQueue = [];
      let allVendors = [];
      let editId = null;

      // Autenticação
      document.getElementById("registerBtn").onclick = () => {
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;
        createUserWithEmailAndPassword(auth, email, password)
          .then(() => alert("Usuário registrado!"))
          .catch(err => alert(err.message));
      };

      document.getElementById("loginBtn").onclick = () => {
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;
        signInWithEmailAndPassword(auth, email, password)
          .then(() => alert("Login realizado!"))
          .catch(err => alert(err.message));
      };

      document.getElementById("logoutBtn").onclick = () => {
        signOut(auth);
      };

      onAuthStateChanged(auth, user => {
        if (user) {
          document.getElementById("authSection").style.display = "none";
          document.getElementById("salesSection").style.display = "block";
          loadVendors(user.uid);
          loadSales(user.uid);
        } else {
          document.getElementById("authSection").style.display = "block";
          document.getElementById("salesSection").style.display = "none";
        }
      });

      // Gerenciar Vendedores
      document.getElementById("addVendorBtn").onclick = () => {
        const vendorName = document.getElementById("vendorName").value.trim();
        if (!vendorName) {
          alert("Por favor, insira o nome do vendedor.");
          return;
        }
        const user = auth.currentUser;
        if (user) {
          const vendorsRef = ref(db, `vendors/${user.uid}`);
          const newVendorRef = push(vendorsRef);
          const isJosy = vendorName.toLowerCase() === "josy";
          set(newVendorRef, {
            name: vendorName,
            order: allVendors.length,
            checkedIn: false,
            priority: isJosy // Define prioridade para Josy
          }).then(() => {
            document.getElementById("vendorName").value = "";
            loadVendors(user.uid);
          }).catch(err => alert("Erro ao adicionar vendedor: " + err.message));
        }
      };

      function loadVendors(uid) {
        const vendorsRef = ref(db, `vendors/${uid}`);
        onValue(vendorsRef, snapshot => {
          const vendorList = document.getElementById("vendorQueue");
          const vendorCheckInList = document.getElementById("vendorCheckInList");
          const vendorSelect = document.getElementById("vendorAssigned");
          vendorList.innerHTML = "";
          vendorCheckInList.innerHTML = "";
          allVendors = [];
          vendorQueue = [];
          if (snapshot.exists()) {
            const data = snapshot.val();
            allVendors = Object.entries(data).map(([id, vendor]) => ({
              id,
              ...vendor
            }));
            allVendors.sort((a, b) => a.order - b.order);
            vendorQueue = allVendors
              .filter(vendor => vendor.checkedIn)
              .sort((a, b) => {
                // Josy (priority: true) sempre vem primeiro se estiver checked-in
                if (a.priority && !b.priority) return -1;
                if (!a.priority && b.priority) return 1;
                return a.order - b.order;
              });

            // Lista de check-in
            allVendors.forEach(vendor => {
              const div = document.createElement("div");
              div.className = "card";
              div.innerHTML = `
                <strong>Vendedor:</strong> ${vendor.name} ${vendor.priority ? '<span style="color: gold;">(Prioridade)</span>' : ''} <br>
                <strong>Check-in:</strong> ${vendor.checkedIn ? '<span style="color: green;">Presente</span>' : '<span style="color: red;">Ausente</span>'} <br>
                <button onclick="toggleCheckIn('${vendor.id}', ${!vendor.checkedIn})"><i class="fas fa-check-circle"></i> ${vendor.checkedIn ? 'Desmarcar' : 'Fazer Check-in'}</button>
                <button onclick="removeVendor('${vendor.id}')"><i class="fas fa-trash"></i> Remover</button>
              `;
              vendorCheckInList.appendChild(div);
            });

            // Fila de vendedores ativos
            if (vendorQueue.length > 0) {
              vendorQueue.forEach((vendor, index) => {
                const div = document.createElement("div");
                div.className = "card";
                div.innerHTML = `
                  <strong>Vendedor:</strong> ${vendor.name} ${vendor.priority ? '<span style="color: gold;">(Prioridade)</span>' : ''} <br>
                  <strong>Posição na Fila:</strong> ${index + 1} <br>
                `;
                vendorList.appendChild(div);
              });
              vendorSelect.innerHTML = `<option value="${vendorQueue[0].id}">${vendorQueue[0].name}</option>`;
            } else {
              vendorList.innerHTML = "Nenhum vendedor com check-in registrado.";
              vendorSelect.innerHTML = `<option value="">Nenhum vendedor disponível</option>`;
            }
          } else {
            vendorList.innerHTML = "Nenhum vendedor registrado.";
            vendorCheckInList.innerHTML = "Nenhum vendedor registrado.";
            vendorSelect.innerHTML = `<option value="">Nenhum vendedor disponível</option>`;
          }
        });
      }

      window.toggleCheckIn = (id, checkInStatus) => {
        const user = auth.currentUser;
        if (!user) return;
        update(ref(db, `vendors/${user.uid}/${id}`), {
          checkedIn: checkInStatus
        }).then(() => {
          loadVendors(user.uid);
        }).catch(err => alert("Erro ao atualizar check-in: " + err.message));
      };

      window.removeVendor = (id) => {
        const user = auth.currentUser;
        if (!user) return;
        if (confirm("Tem certeza que deseja remover este vendedor?")) {
          remove(ref(db, `vendors/${user.uid}/${id}`)).then(() => {
            loadVendors(user.uid);
          }).catch(err => alert("Erro ao remover vendedor: " + err.message));
        }
      };

      // Resetar Fila
      document.getElementById("resetQueueBtn").onclick = () => {
        const user = auth.currentUser;
        if (!user) return;
        if (confirm("Tem certeza que deseja resetar a fila para o padrão?")) {
          const vendorsRef = ref(db, `vendors/${user.uid}`);
          allVendors.forEach((vendor, index) => {
            update(ref(db, `vendors/${user.uid}/${vendor.id}`), {
              order: index
            });
          });
          alert("Fila resetada para o padrão!");
          loadVendors(user.uid);
        }
      };

      // Registrar Atendimento
      document.getElementById("submitSale").onclick = () => {
        const saleResult = document.getElementById("saleResult").value;
        const notSoldReason = document.getElementById("notSoldReason").value.trim();
        const saleDetails = document.getElementById("saleDetails").value.trim();
        const vendorId = document.getElementById("vendorAssigned").value;

        if (!vendorId) {
          alert("Certifique-se de que há vendedores com check-in na fila.");
          return;
        }

        const user = auth.currentUser;
        if (user) {
          const salesRef = ref(db, `sales/${user.uid}`);
          const data = {
            vendorId,
            vendorName: vendorQueue[0]?.name || "",
            saleResult,
            notSoldReason: saleResult === "not_sold" ? notSoldReason : "",
            saleDetails,
            timestamp: new Date().toISOString()
          };

          if (editId) {
            update(ref(db, `sales/${user.uid}/${editId}`), data).then(() => {
              alert("Atendimento atualizado!");
              editId = null;
              clearForm();
              updateVendorQueue(user.uid);
              loadSales(user.uid);
            });
          } else {
            push(salesRef, data).then(() => {
              alert("Atendimento registrado!");
              clearForm();
              updateVendorQueue(user.uid);
              loadSales(user.uid);
            });
          }
        }
      };

      function updateVendorQueue(uid) {
        if (vendorQueue.length > 0) {
          const vendorsRef = ref(db, `vendors/${uid}`);
          const movedVendor = vendorQueue.shift();
          movedVendor.order = allVendors.length;
          vendorQueue.push(movedVendor);
          vendorQueue.forEach((vendor, index) => {
            vendor.order = allVendors.findIndex(v => v.id === vendor.id);
            update(ref(db, `vendors/${uid}/${vendor.id}`), {
              order: vendor.order
            });
          });
          loadVendors(uid);
        }
      }

      function loadSales(uid) {
        const salesRef = ref(db, `sales/${uid}`);
        onValue(salesRef, snapshot => {
          const salesList = document.getElementById("salesList");
          salesList.innerHTML = "";
          currentSalesData = [];
          if (snapshot.exists()) {
            const data = snapshot.val();
            currentSalesData = Object.entries(data).map(([id, sale]) => ({
              id,
              ...sale
            }));
            currentSalesData.forEach(sale => {
              const div = document.createElement("div");
              div.className = "card";
              div.innerHTML = `
                <strong>Vendedor:</strong> ${sale.vendorName}<br>
                <strong>Resultado:</strong> ${sale.saleResult === "sold" ? "Venda Realizada" : "Não Vendido"}<br>
                ${sale.saleResult === "not_sold" ? `<strong>Motivo:</strong> ${sale.notSoldReason}<br>` : ""}
                <strong>Detalhes:</strong> ${sale.saleDetails || "Nenhum"}<br>
                <strong>Data:</strong> ${new Date(sale.timestamp).toLocaleString()}<br>
                <button onclick="editSale('${sale.id}')"><i class="fas fa-edit"></i> Editar</button>
                <button onclick="deleteSale('${sale.id}')"><i class="fas fa-trash"></i> Excluir</button>
              `;
              salesList.appendChild(div);
            });
          } else {
            salesList.innerHTML = "Nenhum atendimento registrado.";
          }
        });
      }

      window.editSale = (id) => {
        const user = auth.currentUser;
        if (!user) return;
        const saleRef = ref(db, `sales/${user.uid}/${id}`);
        onValue(saleRef, snapshot => {
          if (snapshot.exists()) {
            const sale = snapshot.val();
            document.getElementById("saleResult").value = sale.saleResult;
            document.getElementById("notSoldReason").value = sale.notSoldReason;
            document.getElementById("saleDetails").value = sale.saleDetails;
            document.getElementById("notSoldReason").style.display = sale.saleResult === "not_sold" ? "block" : "none";
            editId = id;
          }
        }, {
          onlyOnce: true
        });
      };

      window.deleteSale = (id) => {
        const user = auth.currentUser;
        if (!user) return;
        if (confirm("Tem certeza que deseja excluir este atendimento?")) {
          remove(ref(db, `sales/${user.uid}/${id}`)).then(() => {
            alert("Atendimento excluído!");
            loadSales(user.uid);
          });
        }
      };

      function clearForm() {
        document.getElementById("saleResult").value = "sold";
        document.getElementById("notSoldReason").value = "";
        document.getElementById("saleDetails").value = "";
        document.getElementById("notSoldReason").style.display = "none";
      }

      // Exportar para PDF
      document.getElementById("exportPdfBtn").onclick = async () => {
        if (currentSalesData.length === 0) {
          alert("Não há atendimentos para exportar.");
          return;
        }
        const {
          jsPDF
        } = window.jspdf;
        const doc = new jsPDF();
        let startY = 20;
        try {
          const imageUrl = 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQah2QIOfwC0zx1PXhE11jprq5zvwglscFUFA&s';
          const imageData = await getBase64Image(imageUrl);
          doc.addImage(imageData, 'PNG', 10, 10, 40, 40);
          doc.setFontSize(16);
          doc.text("Relatório Lista da Vez", 55, 30);
          startY = 50;
        } catch (e) {
          console.error("Erro ao carregar imagem:", e);
          doc.setFontSize(16);
          doc.text("Relatório Lista da Vez", 10, 10);
          startY = 20;
        }
        const tableColumn = ["Vendedor", "Resultado", "Motivo Não Venda", "Detalhes", "Data"];
        const tableRows = currentSalesData.map(sale => [
          sale.vendorName,
          sale.saleResult === "sold" ? "Venda Realizada" : "Não Vendido",
          sale.notSoldReason || "-",
          sale.saleDetails || "-",
          new Date(sale.timestamp).toLocaleString()
        ]);
        doc.autoTable({
          head: [tableColumn],
          body: tableRows,
          startY: startY,
          styles: {
            fontSize: 8,
            cellPadding: 2,
            overflow: 'linebreak'
          },
          headStyles: {
            fillColor: [34, 139, 34],
            textColor: [255, 255, 255]
          }, // Verde para o cabeçalho
          alternateRowStyles: {
            fillColor: [240, 240, 240]
          }
        });
        doc.save("relatorio_lista_da_vez.pdf");
      };

      // Exportar para Excel
      document.getElementById("exportExcelBtn").onclick = () => {
        if (currentSalesData.length === 0) {
          alert("Não há atendimentos para exportar.");
          return;
        }
        const worksheet = XLSX.utils.json_to_sheet(currentSalesData.map(sale => ({
          "Vendedor": sale.vendorName,
          "Resultado": sale.saleResult === "sold" ? "Venda Realizada" : "Não Vendido",
          "Motivo Não Venda": sale.notSoldReason || "-",
          "Detalhes": sale.saleDetails || "-",
          "Data": new Date(sale.timestamp).toLocaleString()
        })));
        const workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(workbook, worksheet, "Atendimentos");
        XLSX.writeFile(workbook, "relatorio_lista_da_vez.xlsx");
      };

      // Enviar relatório por WhatsApp
      document.getElementById("sendReportBtn").onclick = () => {
        const phoneNumber = document.getElementById("phoneNumber").value.trim();
        if (!phoneNumber) {
          alert("Por favor, insira um número de telefone.");
          return;
        }
        if (currentSalesData.length === 0) {
          alert("Não há atendimentos para enviar no relatório.");
          return;
        }
        let reportMessage = "Relatório Lista da Vez:\n\n";
        currentSalesData.forEach(sale => {
          reportMessage += `Vendedor: ${sale.vendorName}\n`;
          reportMessage += `Resultado: ${sale.saleResult === "sold" ? "Venda Realizada" : "Não Vendido"}\n`;
          if (sale.saleResult === "not_sold") {
            reportMessage += `Motivo: ${sale.notSoldReason}\n`;
          }
          reportMessage += `Detalhes: ${sale.saleDetails || "Nenhum"}\n`;
          reportMessage += `Data: ${new Date(sale.timestamp).toLocaleString()}\n`;
          reportMessage += `--------------------------------------\n`;
        });
        if (confirm("Isso abrirá o WhatsApp com a mensagem preenchida. Deseja continuar?")) {
          const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(reportMessage)}`;
          window.open(whatsappUrl, '_blank');
        }
      };

      // Alternar visibilidade do campo de motivo
      document.getElementById("saleResult").addEventListener("change", () => {
        const notSoldReason = document.getElementById("notSoldReason");
        notSoldReason.style.display = document.getElementById("saleResult").value === "not_sold" ? "block" : "none";
      });

      // Modo escuro
      const themeToggle = document.getElementById("themeToggle");
      themeToggle.addEventListener("click", () => {
        const currentTheme = document.body.getAttribute("data-theme") || "light";
        const newTheme = currentTheme === "light" ? "dark" : "light";
        document.body.setAttribute("data-theme", newTheme);
        themeToggle.innerHTML = newTheme === "light" ? '<i class="fas fa-moon"></i>' : '<i class="fas fa-sun"></i>';
        localStorage.setItem("theme", newTheme);
      });

      const savedTheme = localStorage.getItem("theme") || "light";
      document.body.setAttribute("data-theme", savedTheme);
      themeToggle.innerHTML = savedTheme === "light" ? '<i class="fas fa-moon"></i>' : '<i class="fas fa-sun"></i>';

      // Funcionalidade de accordion
      document.querySelectorAll(".accordion-header").forEach(header => {
        header.addEventListener("click", () => {
          const content = header.nextElementSibling;
          content.classList.toggle("active");
        });
      });

      // Função auxiliar para carregar imagem como base64
      function getBase64Image(url) {
        return new Promise((resolve, reject) => {
          const img = new Image();
          img.crossOrigin = 'Anonymous';
          img.src = url;
          img.onload = () => {
            const canvas = document.createElement('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0);
            const dataURL = canvas.toDataURL('image/png');
            resolve(dataURL);
          };
          img.onerror = (err) => reject(err);
        });
      }
    </script>

  </body>

</html>